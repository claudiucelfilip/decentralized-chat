(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{28:function(e,t,a){"use strict";(function(e){var n=a(2),r=a.n(n),c=a(31),l=a(6),o=a(4),s=a(0),i=a.n(s),u=a(7),d=a(1),m=a(12),h=a.n(m).a.BigInt;t.a=function(){var t=Object(s.useState)("https://testnet.perlin.net"),a=Object(o.a)(t,2),n=a[0],m=a[1],b=Object(s.useState)(e.from(u.Wavelet.generateNewWallet().secretKey,"binary").toString("hex")),f=Object(o.a)(b,2),p=f[0],E=f[1],x=Object(s.useState)(void 0),w=Object(o.a)(x,2),v=w[0],g=w[1],y=Object(s.useState)(void 0),j=Object(o.a)(y,2),O=j[0],k=j[1],B=Object(s.useState)("9f549686e464b2addfdcd5061deeeb7c622ea430c5f93ddaf5cf8a8f114f8b65"),F=Object(o.a)(B,2),S=F[0],W=F[1],C=Object(s.useState)(void 0),P=Object(o.a)(C,2),A=P[0],_=P[1],K=Object(s.useState)(""),R=Object(o.a)(K,2),L=R[0],N=R[1],D=Object(s.useState)([]),J=Object(o.a)(D,2),M=J[0],z=J[1],I=Object(s.useState)(void 0),T=Object(o.a)(I,2),U=T[0],Y=T[1],$=Object(s.useRef)(U);Object(s.useEffect)(function(){$.current=U},[U]);var q=Object(s.useState)({accounts:void 0,consensus:void 0}),G=Object(o.a)(q,2),H=G[0],Q=G[1],V=Object(s.useRef)(H);Object(s.useEffect)(function(){V.current=H},[H]);var X=function(){g(void 0),Y(void 0),k(void 0),_(void 0),W(""),N(""),z([]);var e=V.current;e.accounts&&e.accounts.close(1e3,"connection closing normally"),e.consensus&&e.consensus.close(1e3,"connection closing normally"),Q({accounts:void 0,consensus:void 0})},Z=function(){var t=Object(l.a)(r.a.mark(function t(){var a,l,o;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0!==v){t.next=28;break}return t.prev=1,a=new u.Wavelet(n),t.t0=k,t.next=6,a.getNodeInfo();case 6:return t.t1=t.sent,(0,t.t0)(t.t1),l=u.Wavelet.loadWalletFromPrivateKey(p),o=e.from(l.publicKey).toString("hex"),t.t2=Y,t.next=13,a.getAccount(o);case 13:return t.t3=t.sent,(0,t.t2)(t.t3),g(a),t.next=18,a.pollAccounts({onAccountUpdated:function(e){e.forEach(function(e){switch(e.event){case"balance_updated":Y(Object(c.a)({},$.current,{balance:e.balance}))}})}},{id:o});case 18:H.accounts=t.sent,Q(H),t.next=26;break;case 22:t.prev=22,t.t4=t.catch(1),X(),alert(t.t4);case 26:t.next=29;break;case 28:X();case 29:case"end":return t.stop()}},t,null,[[1,22]])}));return function(){return t.apply(this,arguments)}}(),ee=function(){var e=Object(l.a)(r.a.mark(function e(){var t;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=new u.Contract(v,S),e.next=3,t.init();case 3:return e.next=5,v.pollConsensus({onRoundEnded:function(e){void 0!==t&&Object(l.a)(r.a.mark(function e(){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.fetchAndPopulateMemoryPages();case 2:z(t.test("get_messages",h(0)).logs);case 3:case"end":return e.stop()}},e)}))()}});case 5:H.consensus=e.sent,Q(H),z(t.test("get_messages",h(0)).logs),_(t);case 9:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),te=function(){var e=Object(l.a)(r.a.mark(function e(){var t;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=u.Wavelet.loadWalletFromPrivateKey(p),e.next=3,A.call(t,"send_message",h(0),h(25e4),{type:"string",value:L});case 3:N("");case 4:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}();return i.a.createElement(i.a.Fragment,null,i.a.createElement(d.Flex,null,i.a.createElement(d.Box,{style:{textAlign:"center"},width:1},i.a.createElement("h2",null,"A decentralized chat written in JavaScript + Rust (WebAssembly)."))),i.a.createElement(d.Flex,{style:{marginTop:"-0.9em",marginBottom:"4em"}},i.a.createElement(d.Box,{style:{textAlign:"center"},width:1},"Powered by ",i.a.createElement("a",{href:"https://wavelet.perlin.net"},"Wavelet"),". Click ",i.a.createElement("a",{href:"https://medium.com/perlin-network/build-a-decentralized-chat-using-javascript-rust-webassembly-c775f8484b52"},"here")," to learn how it works, and ",i.a.createElement("a",{href:"https://github.com/perlin-network/decentralized-chat"},"here")," for the source code. Join our ",i.a.createElement("a",{href:"https://discord.gg/dMYfDPM"},"Discord")," to get PERLs.")),i.a.createElement(d.Flex,{mb:2},i.a.createElement(d.Box,{width:"200px"},i.a.createElement("label",null,"[secret]")),i.a.createElement(d.Box,{width:1},i.a.createElement("input",{type:"text",value:p,disabled:v,"data-lpignore":"true",onChange:function(e){return E(e.target.value)}}))),i.a.createElement(d.Flex,{mb:2},i.a.createElement(d.Box,{width:"200px"},i.a.createElement("label",null,"[node]")),i.a.createElement(d.Box,{width:1},i.a.createElement(d.Flex,{width:1},i.a.createElement(d.Box,{width:.75},i.a.createElement("input",{type:"text",value:n,disabled:v,"data-lpignore":"true",onKeyPress:function(){var e=Object(l.a)(r.a.mark(function e(t){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("Enter"!==t.key){e.next=3;break}return e.next=3,Z();case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),onChange:function(e){return m(e.target.value)}})),i.a.createElement(d.Box,{width:.25,style:{minWidth:"10em"}},i.a.createElement("button",{style:{width:"100%",float:"right"},onClick:Z,disabled:128!==p.length},v?"Disconnect":"Connect"))))),i.a.createElement(d.Flex,{mb:4},i.a.createElement(d.Box,{width:"200px"},i.a.createElement("label",null,"[contract]")),i.a.createElement(d.Box,{width:1},i.a.createElement(d.Flex,{width:1},i.a.createElement(d.Box,{width:.75},i.a.createElement("input",{type:"text",value:S,placeholder:"input chat smart contract address...",disabled:!v,"data-lpignore":"true",onKeyPress:function(){var e=Object(l.a)(r.a.mark(function e(t){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("Enter"!==t.key){e.next=3;break}return e.next=3,ee();case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),onChange:function(e){return W(e.target.value)}})),i.a.createElement(d.Box,{width:.25,style:{minWidth:"10em"}},i.a.createElement("button",{style:{width:"100%",float:"right"},disabled:!v||64!==S.length,onClick:ee},"Load Contract"))))),i.a.createElement(d.Flex,{mb:2},i.a.createElement(d.Box,{width:155},i.a.createElement("label",null,"[node id]")),i.a.createElement(d.Box,{width:10/12},i.a.createElement("span",null,"".concat(O&&O.public_key?O.public_key:"???")))),i.a.createElement(d.Flex,{mb:2},i.a.createElement(d.Box,{width:155},i.a.createElement("label",null,"[your id]")),i.a.createElement(d.Box,{width:10/12},i.a.createElement("span",null,"".concat(U&&U.public_key?U.public_key:"???")))),i.a.createElement(d.Flex,{mb:4},i.a.createElement(d.Box,{width:155},i.a.createElement("label",null,"[balance]")),i.a.createElement(d.Box,{width:10/12},i.a.createElement("span",null,"".concat(U&&U.balance?U.balance:0," PERL(s)")))),i.a.createElement(d.Flex,{mb:3},i.a.createElement(d.Box,{width:.5,pr:3},i.a.createElement("textarea",{disabled:!v||!A,value:L,placeholder:"enter a message...",maxLength:240,onKeyPress:function(e){"Enter"===e.key&&(U.balance>=25e4&&L.length>0&&L.length<=240?te():e.preventDefault())},onChange:function(e){return N(e.target.value)},className:"fw"})),i.a.createElement(d.Box,{width:.5},i.a.createElement("button",{className:"fw",style:{height:"100%",minWidth:"12.5em"},disabled:!v||!A||!U||U.balance<25e4||0===L.length,onClick:te},"Send Message [250,000 PERLs]"))),i.a.createElement(d.Flex,null,i.a.createElement(d.Box,{width:1},i.a.createElement("textarea",{disabled:!v||!A,className:"fw",style:{height:"100%"},rows:40,readOnly:!0,placeholder:"no messages here so far chief...",value:1===M.length?M[0]:""}))))}}).call(this,a(9).Buffer)},34:function(e,t,a){e.exports=a(89)},39:function(e,t,a){},63:function(e,t){},89:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(27),l=a.n(c),o=(a(39),a(28));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(r.a.createElement(o.a,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[34,1,2]]]);
//# sourceMappingURL=main.7ca76ca8.chunk.js.map