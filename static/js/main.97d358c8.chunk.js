(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{28:function(e,t,a){"use strict";(function(e){var n=a(2),c=a.n(n),r=a(31),l=a(6),o=a(4),s=a(0),i=a.n(s),u=a(7),m=a(1),d=a(12),f=a.n(d).a.BigInt;t.a=function(){var t=Object(s.useState)("https://testnet.perlin.net"),a=Object(o.a)(t,2),n=a[0],d=a[1],b=Object(s.useState)(e.from(u.Wavelet.generateNewWallet().secretKey,"binary").toString("hex")),p=Object(o.a)(b,2),x=p[0],h=p[1],E=Object(s.useState)(void 0),v=Object(o.a)(E,2),g=v[0],w=v[1],y=Object(s.useState)(void 0),k=Object(o.a)(y,2),j=k[0],O=k[1],B=Object(s.useState)("9f549686e464b2addfdcd5061deeeb7c622ea430c5f93ddaf5cf8a8f114f8b65"),W=Object(o.a)(B,2),S=W[0],C=W[1],F=Object(s.useState)(void 0),P=Object(o.a)(F,2),_=P[0],I=P[1],N=Object(s.useState)(""),K=Object(o.a)(N,2),R=K[0],A=K[1],L=Object(s.useState)([]),D=Object(o.a)(L,2),J=D[0],M=D[1],z=Object(s.useState)(void 0),U=Object(o.a)(z,2),Y=U[0],$=U[1],q=Object(s.useRef)(Y);Object(s.useEffect)(function(){q.current=Y},[Y]);var G=Object(s.useState)({accounts:void 0,consensus:void 0}),H=Object(o.a)(G,2),Q=H[0],T=H[1],V=Object(s.useRef)(Q);Object(s.useEffect)(function(){V.current=Q},[Q]);var X=function(){w(void 0),$(void 0),O(void 0),I(void 0),C(""),A(""),M([]);var e=V.current;e.accounts&&e.accounts.close(1e3,"connection closing normally"),e.consensus&&e.consensus.close(1e3,"connection closing normally"),T({accounts:void 0,consensus:void 0})},Z=function(){var t=Object(l.a)(c.a.mark(function t(){var a,l,o;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0!==g){t.next=28;break}return t.prev=1,a=new u.Wavelet(n),t.t0=O,t.next=6,a.getNodeInfo();case 6:return t.t1=t.sent,(0,t.t0)(t.t1),l=u.Wavelet.loadWalletFromPrivateKey(x),o=e.from(l.publicKey).toString("hex"),t.t2=$,t.next=13,a.getAccount(o);case 13:return t.t3=t.sent,(0,t.t2)(t.t3),w(a),t.next=18,a.pollAccounts({onAccountUpdated:function(e){e.forEach(function(e){switch(e.event){case"balance_updated":$(Object(r.a)({},q.current,{balance:e.balance}))}})}},{id:o});case 18:Q.accounts=t.sent,T(Q),t.next=26;break;case 22:t.prev=22,t.t4=t.catch(1),X(),alert(t.t4);case 26:t.next=29;break;case 28:X();case 29:case"end":return t.stop()}},t,null,[[1,22]])}));return function(){return t.apply(this,arguments)}}(),ee=function(){var e=Object(l.a)(c.a.mark(function e(){var t;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=new u.Contract(g,S),e.next=3,t.init();case 3:return e.next=5,g.pollConsensus({onRoundEnded:function(e){void 0!==t&&Object(l.a)(c.a.mark(function e(){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.fetchAndPopulateMemoryPages();case 2:M(t.test("get_messages",f(0)).logs);case 3:case"end":return e.stop()}},e)}))()}});case 5:Q.consensus=e.sent,T(Q),M(t.test("get_messages",f(0)).logs),I(t);case 9:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),te=function(){var e=Object(l.a)(c.a.mark(function e(){var t;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=u.Wavelet.loadWalletFromPrivateKey(x),e.next=3,_.call(t,"send_message",f(0),f(25e4),{type:"string",value:R});case 3:A("");case 4:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}();return i.a.createElement(i.a.Fragment,null,i.a.createElement("h2",{className:"text-center title"},"A decentralized chat written in JavaScript + Rust (WebAssembly)."),i.a.createElement(m.Box,{className:"text-center",mb:4},"Powered by ",i.a.createElement("a",{href:"https://wavelet.perlin.net"},"Wavelet"),". Click"," ",i.a.createElement("a",{href:"https://medium.com/perlin-network/build-a-decentralized-chat-using-javascript-rust-webassembly-c775f8484b52"},"here")," to learn how it works, and"," ",i.a.createElement("a",{href:"https://github.com/perlin-network/decentralized-chat"},"here")," ","for the source code. Join our"," ",i.a.createElement("a",{href:"https://discord.gg/dMYfDPM"},"Discord")," to get PERLs."),i.a.createElement(m.Flex,{mb:2,alignItems:"center"},i.a.createElement(m.Box,{flex:"0 0 150px"},i.a.createElement("label",null,"[secret]")),i.a.createElement(m.Box,{flex:"1"},i.a.createElement("input",{type:"text",value:x,disabled:g,"data-lpignore":"true",onChange:function(e){return h(e.target.value)}}))),i.a.createElement(m.Flex,{mb:2,alignItems:"center"},i.a.createElement(m.Box,{flex:"0 0 150px"},i.a.createElement("label",null,"[node]")),i.a.createElement(m.Box,{flex:"1"},i.a.createElement(m.Flex,{width:1},i.a.createElement(m.Box,{width:.75},i.a.createElement("input",{type:"text",value:n,disabled:g,"data-lpignore":"true",onKeyPress:function(){var e=Object(l.a)(c.a.mark(function e(t){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("Enter"!==t.key){e.next=3;break}return e.next=3,Z();case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),onChange:function(e){return d(e.target.value)}})),i.a.createElement(m.Box,{width:.25,style:{minWidth:"10em"},ml:2},i.a.createElement("button",{style:{width:"100%"},onClick:Z,disabled:128!==x.length},g?"Disconnect":"Connect"))))),i.a.createElement(m.Flex,{mb:4,alignItems:"center"},i.a.createElement(m.Box,{flex:"0 0 150px"},i.a.createElement("label",null,"[contract]")),i.a.createElement(m.Box,{flex:"1"},i.a.createElement(m.Flex,{width:1},i.a.createElement(m.Box,{width:.75},i.a.createElement("input",{type:"text",value:S,placeholder:"input chat smart contract address...",disabled:!g,"data-lpignore":"true",onKeyPress:function(){var e=Object(l.a)(c.a.mark(function e(t){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("Enter"!==t.key){e.next=3;break}return e.next=3,ee();case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),onChange:function(e){return C(e.target.value)}})),i.a.createElement(m.Box,{width:.25,style:{minWidth:"10em"},ml:2},i.a.createElement("button",{style:{width:"100%"},disabled:!g||64!==S.length,onClick:ee},"Load Contract"))))),i.a.createElement(m.Flex,{mb:2,alignItems:"center"},i.a.createElement(m.Box,{flex:"0 0 150px"},i.a.createElement("label",null,"[node id]")),i.a.createElement(m.Box,{flex:"1",style:{minWidth:0}},i.a.createElement("span",{className:"truncate",title:"".concat(j&&j.public_key?j.public_key:"???")},"".concat(j&&j.public_key?j.public_key:"???")))),i.a.createElement(m.Flex,{mb:2,alignItems:"center"},i.a.createElement(m.Box,{flex:"0 0 150px"},i.a.createElement("label",null,"[your id]")),i.a.createElement(m.Box,{flex:"1",style:{minWidth:0}},i.a.createElement("span",{className:"truncate",title:"".concat(Y&&Y.public_key?Y.public_key:"???")},"".concat(Y&&Y.public_key?Y.public_key:"???")))),i.a.createElement(m.Flex,{mb:4,alignItems:"center"},i.a.createElement(m.Box,{flex:"0 0 150px"},i.a.createElement("label",null,"[balance]")),i.a.createElement(m.Box,{flex:"1"},i.a.createElement("span",null,"".concat(Y&&Y.balance?Y.balance:0," PERL(s)")))),i.a.createElement(m.Flex,{mb:3},i.a.createElement(m.Box,{flex:"1",pr:2},i.a.createElement("textarea",{disabled:!g||!_,value:R,placeholder:"enter a message...",maxLength:240,onKeyPress:function(e){"Enter"===e.key&&(Y.balance>=25e4&&R.length>0&&R.length<=240?te():e.preventDefault())},onChange:function(e){return A(e.target.value)},className:"fw"})),i.a.createElement(m.Box,{flex:"0 0 220px"},i.a.createElement("button",{className:"fw",style:{height:"98%"},disabled:!g||!_||!Y||Y.balance<25e4||0===R.length,onClick:te},"Send Message [250,000 PERLs]"))),i.a.createElement("textarea",{disabled:!g||!_,className:"fw",rows:35,readOnly:!0,placeholder:"no messages here so far chief...",value:1===J.length?J[0]:""}))}}).call(this,a(9).Buffer)},34:function(e,t,a){e.exports=a(89)},39:function(e,t,a){},63:function(e,t){},89:function(e,t,a){"use strict";a.r(t);var n=a(0),c=a.n(n),r=a(27),l=a.n(r),o=(a(39),a(28));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(c.a.createElement(o.a,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[34,1,2]]]);
//# sourceMappingURL=main.97d358c8.chunk.js.map